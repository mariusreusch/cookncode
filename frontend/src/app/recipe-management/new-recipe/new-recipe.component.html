<mat-card>
  <mat-card-header>
    <mat-card-title><h1>Erstelle ein neues Rezept</h1></mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <form (ngSubmit)="onSubmit()" #recipeForm="ngForm">
      <mat-input-container class="cac-full-width-input">
        <input mat-line matInput
               placeholder="Recipe Name"
               name="recipeName"
               required
               [(ngModel)]="newRecipe.name">
      </mat-input-container>
      <mat-input-container class="cac-full-width-input">
        <input mat-line matInput
               placeholder="Number Of Portions"
               name="numberOfPortions"
               type="number"
               required
               [(ngModel)]="newRecipe.numberOfPortions">
      </mat-input-container>
      <mat-input-container class="cac-full-width-input">
        <input mat-line matInput
               placeholder="Categories (comma separated)"
               name="numberOfPortions"
               required
               [(ngModel)]="categoriesAsCommaSeparatedString">
      </mat-input-container>
      <mat-input-container class="cac-full-width-input">
        <textarea matInput
                  name="instruction"
                  placeholder="Instruction"
                  rows="4"
                  required
                  [(ngModel)]="newRecipe.instruction">
        </textarea>
      </mat-input-container>
    </form>

    <h3>Ingredients</h3>
    <mat-list>
      <mat-list-item *ngFor="let ingredient of newRecipe.ingredients">
        <div mat-line style="display: flex;">
          <div style="display: flex; align-self: center;"> {{ingredient.amount}} {{ingredient.unitOfMeasurement}}
            {{ingredient.name}}
          </div>
          <mat-icon class="cac-remove-ingredient-btn" (click)="removeIngredient(ingredient)">clear</mat-icon>
        </div>
      </mat-list-item>
    </mat-list>

    <form #ingredientForm="ngForm" (ngSubmit)="addIngredient()" onsubmit="ingredientAmount.focus()">
      <mat-input-container>
        <input matInput
               placeholder="Amount"
               type="number"
               name="ingredientAmount"
               [(ngModel)]="newIngredient.amount"
               required>
      </mat-input-container>
      <mat-input-container>
        <input matInput
               placeholder="Measuring Unit"
               name="measuringUnit"
               [(ngModel)]="newIngredient.unitOfMeasurement"
               required>
      </mat-input-container>
      <mat-input-container>
        <input matInput
               placeholder="Ingredient Name"
               name="ingredientName"
               [(ngModel)]="newIngredient.name"
               required>
      </mat-input-container>

      <button [disabled]="!ingredientForm.form.valid"
              mat-mini-fab>
        <mat-icon>add</mat-icon>
      </button>
    </form>

    <h3>Pictures</h3>

    <kub-file-upload (onFileSelected)="addImage($event)"></kub-file-upload>

    <div>
    <span *ngFor="let image of newRecipe.images">
      <img src="{{image.content}}" alt="" width="200">
    </span>
    </div>

    <mat-divider></mat-divider>

  </mat-card-content>
  <mat-card-actions>
    <button mat-button [disabled]="!recipeForm.form.valid || newRecipe.ingredients.length < 1"
            (click)="recipeForm.ngSubmit.emit()">Tue Fantastisches!
    </button>
  </mat-card-actions>
</mat-card>
